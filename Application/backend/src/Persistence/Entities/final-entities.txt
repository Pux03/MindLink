using System.ComponentModel.DataAnnotations;

namespace Persistence.Entities
{
    public abstract class BaseEntity
    {
        [Key]
        public int Id { get; set; }
        public DateTime CreatedAt { get; set; } = DateTime.UtcNow;
        public DateTime? UpdatedAt { get; set; }
    }
}using System.ComponentModel.DataAnnotations.Schema;

namespace Persistence.Entities
{
    [Table("boards")]
    public class BoardEntity : BaseEntity
    {
        public int GameSessionId { get; set; }
        // public GameSessionEntity? GameSession { get; set; }
        public int Size { get; set; } = 25;
        // public ICollection<CardEntity> Cards { get; set; } = [];
    
        [Column(TypeName = "jsonb")]
        public List<CardEntity> Cards { get; set; } = [];
    }
}
using Core.Enums;

namespace Persistence.Entities
{
    public class CardEntity
    {
        public string Word { get; set; } = string.Empty;
        public TeamColor? TeamColor { get; set; }
        public bool IsRevealed { get; set; } = false;
        public int Position { get; set; }

        // Ovo ne bi trebalo da postoji ako ga cuvamo kao json
        // public int BoardId { get; set; }
        // public BoardEntity? Board { get; set; }
    }
}using System.ComponentModel.DataAnnotations.Schema;
using Core.Enums;

namespace Persistence.Entities
{
    [Table("game_sessions")]
    public class GameSessionEntity : BaseEntity
    {
        public string Name { get; set; } = string.Empty;

        // Board
        public BoardEntity? Board { get; set; }

        // Teams
        public int RedTeamId { get; set; }
        public TeamEntity? RedTeam { get; set; }

        public int BlueTeamId { get; set; }
        public TeamEntity? BlueTeam { get; set; }

        public TeamColor CurrentTeam { get; set; } = TeamColor.Blue;
        public GameStatus Status { get; set; } = GameStatus.Active;
        public TeamColor? Winner { get; set; }

        public ICollection<GuessEntity> GuessHistory { get; set; } = [];
        public ICollection<HintEntity> Hints { get; set; } = [];

        public DateTime StartTime { get; set; } = DateTime.UtcNow;
        public DateTime? EndTime { get; set; }
    }
}using System.ComponentModel.DataAnnotations.Schema;

namespace Persistence.Entities
{
    [Table("guesses")]
    public class GuessEntity : BaseEntity
    {
        public int Index { get; set; }
        
        // FK Player
        public int PlayerId { get; set; }
        public PlayerEntity? Player { get; set; }

        public int CardPosition { get; set; }

        // Ako se cuvaju u json-u onda nema potrebe, cuva se samo pozicija kartice u json nizu
        // public int CardId { get; set; }
        // public CardEntity? Card { get; set; }

        // FK GameSession
        public int GameSessionId { get; set; }
        public GameSessionEntity? GameSession { get; set; }

        public DateTime ExecutedAt { get; set; } = DateTime.UtcNow;
    }
}using System.ComponentModel.DataAnnotations.Schema;

namespace Persistence.Entities
{
    [Table("hints")]
    public class HintEntity : BaseEntity
    {
        public string Word { get; set; } = string.Empty;
        public int WordCount { get; set; }

        // FK Player
        public int PlayerId { get; set; }
        public PlayerEntity Player { get; set; }

        // FK GameSession
        public int GameSessionId { get; set; }
        public GameSessionEntity GameSession { get; set; }
    }
}
using Core.Enums;
using System.ComponentModel.DataAnnotations.Schema;

namespace Persistence.Entities
{
    [Table("players")]
    public class PlayerEntity : BaseEntity
    {
        public string Username { get; set; } = string.Empty;
        public bool IsMindreader { get; set; } = false;
        public bool IsPlaying { get; set; } = false;

        // Navigacija
        public int? TeamId { get; set; }
        public TeamEntity? Team { get; set; }

        public ICollection<GuessEntity> Guesses { get; set; } = [];
        public ICollection<HintEntity> Hints { get; set; } = [];
    }

}using System.ComponentModel.DataAnnotations.Schema;
using Core.Enums;

namespace Persistence.Entities
{
    [Table("teams")]
    public class TeamEntity : BaseEntity
    {
        public string Name { get; set; } = string.Empty;
        public TeamColor Color { get; set; }
        public int Score { get; set; } = 0;
        public ICollection<PlayerEntity> Members { get; set; } = [];
    }
}
